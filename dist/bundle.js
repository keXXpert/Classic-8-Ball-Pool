!function(t){var e={};function o(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=e,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=50)}([function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GameConfig=void 0;const i=o(29);e.GameConfig={gameSize:{x:1500,y:825},soundOn:!0,timeoutToHideStickAfterShot:500,timeoutToHideBallAfterPocket:100,loadingScreenTimeout:1e3,loadingScreenImagePosition:{x:450,y:112.5},hitMarketPosition:{x:1510,y:100},hitMarketDiameter:64,hitPowerIndicatorPosition:{x:1542,y:250},timeoutToLoadSubMenu:100,labels:{currentPlayer:{position:{x:640,y:260},color:"#126736",font:"70px Impact",alignment:"top",text:"PLAYER "},overalScores:[{position:{x:628,y:460},color:"#126736",font:"200px Impact",alignment:"top"},{position:{x:778,y:460},color:"#126736",font:"200px Impact",alignment:"top"}]},yellowBallsPositions:[{x:1056,y:433},{x:1090,y:374},{x:1126,y:393},{x:1126,y:472},{x:1162,y:335},{x:1162,y:374},{x:1162,y:452}],redBallsPositions:[{x:1022,y:413},{x:1056,y:393},{x:1090,y:452},{x:1126,y:354},{x:1126,y:433},{x:1162,y:413},{x:1162,y:491}],cueBallPosition:{x:413,y:413},eightBallPosition:{x:1090,y:413},matchScore:{scoresPositions:[{x:420,y:27},{x:932,y:27}],unitMargin:20},sprites:{basePath:"assets/sprites/",paths:{menuBackground:"main_menu_background.png",table:"spr_background4.png",cueBall:"spr_ball2.png",redBall:"spr_redBall2.png",yellowBall:"spr_yellowBall2.png",blackBall:"spr_blackBall2.png",stick:"spr_stick.png",twoPlayersButton:"2_players_button.png",twoPlayersButtonHovered:"2_players_button_hover.png",onePlayerButton:"1_player_button.png",onePlayerButtonHovered:"1_player_button_hover.png",muteButton:"mute_button.png",muteButtonHovered:"mute_button_hover.png",muteButtonPressed:"mute_button_pressed.png",muteButtonPressedHovered:"mute_button_pressed_hover.png",easyButton:"easy_button.png",easyButtonHovered:"easy_button_hover.png",mediumButton:"medium_button.png",mediumButtonHovered:"medium_button_hover.png",hardButton:"hard_button.png",hardButtonHovered:"hard_button_hover.png",backButton:"back_button.png",backButtonHovered:"back_button_hover.png",continueButton:"continue_button.png",continueButtonHovered:"continue_button_hover.png",insaneButton:"insane_button.png",insaneButtonHovered:"insane_button_hover.png",controls:"controls.png",redScore:"red_score.png",yellowScore:"yellow_score.png",ball9:"ballSprite9.png",ball10:"ballSprite10.png",ball11:"ballSprite11.png",ball12:"ballSprite12.png",ball13:"ballSprite13.png",ball14:"ballSprite14.png",ball15:"ballSprite15.png",solidBalls:"solidsSprite.png",labelsSprite:"spotSprite.png",hitMarker:"ball.png"}},sounds:{basePath:"assets/sounds/",paths:{ballsCollide:"BallsCollide.wav",strike:"Strike.wav",rail:"Hole.wav"}},physics:{friction:.018,collisionLoss:.018,rotationFriction:.01,counterRotationFriction:.012,rotationToVelocity:.2,powerToRotationRatio:.1},table:{cushionWidth:57,pocketRadius:48,pocketsPositions:[{x:62,y:62},{x:750,y:32},{x:1435,y:62},{x:62,y:762},{x:750,y:794},{x:1435,y:762}]},ball:{diameter:38,origin:{x:25,y:25},minVelocityLength:.05,maxExpectedVelocity:120,maxExpectedCollisionForce:70},stick:{origin:{x:970,y:11},shotOrigin:{x:950,y:11},powerToAddPerFrame:1,movementPerFrame:3,maxPower:50},input:{mouseSelectButton:0,mouseShootButton:0,mousePlaceBallButton:0,mouseToggleHitlineButton:2,toggleMenuKey:27,upHitKey:87,downHitKey:83,leftHitKey:65,rightHitKey:68},mainMenu:{labels:[{text:"Classic 8-Ball",position:{x:200,y:100},font:"100px Bookman",color:"white",alignment:"left"},{text:`© ${(new Date).getFullYear()} Sean McLaggan`,position:{x:1250,y:800},font:"20px Bookman",color:"white",alignment:"left"}],buttons:[{action:i.MenuActionType.PVP,position:{x:200,y:200},sprite:"twoPlayersButton",spriteOnHover:"twoPlayersButtonHovered"},{action:i.MenuActionType.GoToSubMenu,value:0,position:{x:200,y:400},sprite:"onePlayerButton",spriteOnHover:"onePlayerButtonHovered"},{action:i.MenuActionType.ToggleSound,position:{x:1430,y:10},sprite:"muteButton",spriteOnHover:"muteButtonHovered"}],subMenus:[{labels:[{text:"Choose Difficulty",position:{x:200,y:80},font:"70px Bookman",color:"white",alignment:"left"},{text:`© ${(new Date).getFullYear()} Sean McLaggan`,position:{x:1250,y:800},font:"20px Bookman",color:"white",alignment:"left"}],buttons:[{action:i.MenuActionType.GoToPreviousMenu,position:{x:100,y:150},sprite:"backButton",spriteOnHover:"backButtonHovered"},{action:i.MenuActionType.PVC,position:{x:200,y:150},value:30,sprite:"easyButton",spriteOnHover:"easyButtonHovered"},{action:i.MenuActionType.PVC,position:{x:200,y:300},value:50,sprite:"mediumButton",spriteOnHover:"mediumButtonHovered"},{action:i.MenuActionType.PVC,position:{x:200,y:450},value:100,sprite:"hardButton",spriteOnHover:"hardButtonHovered"},{action:i.MenuActionType.PVC,position:{x:200,y:600},value:700,sprite:"insaneButton",spriteOnHover:"insaneButtonHovered"},{action:i.MenuActionType.ToggleSound,position:{x:1430,y:10},sprite:"muteButton",spriteOnHover:"muteButtonHovered"}],subMenus:[]}]},cursor:{default:"default",button:"pointer"},ai:{on:!0,trainIterations:30,playerIndex:1,ballDistanceBonus:1/5800,validTurnBonus:5e3,pocketedBallBonus:2e3,invalidTurnPenalty:3e3,gameWonBonus:5e4,gameLossPenalty:5e4,shotPowerMutationVariance:15,minShotPower:10}}},function(t,e,o){var i=o(32),n="object"==typeof self&&self&&self.Object===Object&&self,s=i||n||Function("return this")();t.exports=s},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Canvas2D=void 0;const i=o(0),n=o(4),s=o(5),r=o(47),a=o(15);const c=document.getElementById("screen"),l=document.getElementById("gameArea");e.Canvas2D=new class{constructor(t,e){this._canvasContainer=e,this._canvas=t,this._context=this._canvas.getContext("2d"),this.resizeCanvas()}get scaleX(){return this._scale.x}get scaleY(){return this._scale.y}get offsetX(){return this._offset.x}get offsetY(){return this._offset.y}resizeCanvas(){const t=i.GameConfig.gameSize.x,e=i.GameConfig.gameSize.y,o=t/e;let n=window.innerHeight,r=window.innerWidth-100;r/n>o?r=n*o:n=r/o,this._canvasContainer.style.width=r+100+"px",this._canvasContainer.style.height=n+"px",this._canvasContainer.style.marginTop=(window.innerHeight-n)/2+"px",this._canvasContainer.style.marginLeft=(window.innerWidth-r-100)/2+"px",this._canvasContainer.style.marginBottom=(window.innerHeight-n)/2+"px",this._canvasContainer.style.marginRight=(window.innerWidth-r-100)/2+"px",this._scale=new s.Vector2(r/t,n/e),this._canvas.width=r+100,this._canvas.height=n,this._canvas.offsetParent&&(this._offset=new s.Vector2(this._canvas.offsetLeft,this._canvas.offsetTop))}clear(){this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}drawPowerGraph(){const t=i.GameConfig.hitPowerIndicatorPosition;this._context.save(),this._context.scale(this._scale.x,this._scale.y),this._context.translate(t.x,t.y),this._context.beginPath(),this._context.lineWidth=3,this._context.strokeStyle="white",this._context.arc(0,0,10,-Math.PI,0,!1),this._context.lineTo(10,400),this._context.arc(0,400,10,0,-Math.PI,!1),this._context.lineTo(-10,0),this._context.stroke(),this._context.restore()}drawHitPower(t=0){const e=i.GameConfig.hitPowerIndicatorPosition,o=400*(1-t/50);this._context.save(),this._context.scale(this._scale.x,this._scale.y),this._context.translate(e.x,e.y),this._context.beginPath(),this._context.lineWidth=3,this._context.strokeStyle="yellow",this._context.arc(0,400,9,0,-Math.PI,!1),this._context.arc(0,o,9,-Math.PI,0,!1),this._context.fillStyle="yellow",this._context.fill(),this._context.restore()}drawHitPosition(t={x:0,y:0}){const e=i.GameConfig.hitMarketPosition,o=i.GameConfig.hitMarketDiameter/2;this._context.save(),this._context.scale(this._scale.x,this._scale.y),this._context.translate(e.x+o,e.y+o),this._context.beginPath(),this._context.lineWidth=3,this._context.strokeStyle="red",this._context.moveTo(t.x*o-6,-t.y*o),this._context.lineTo(t.x*o+6,-t.y*o),this._context.moveTo(t.x*o,-t.y*o-6),this._context.lineTo(t.x*o,-t.y*o+6),this._context.stroke(),this._context.restore()}drawHitLine(t={x:0,y:0},e=0){this._context.save(),this._context.scale(this._scale.x,this._scale.y),this._context.translate(t.x,t.y),this._context.beginPath(),this._context.moveTo(0,0),this._context.rotate(e),this._context.setLineDash([10,15]),this._context.lineWidth=4,this._context.strokeStyle="red",this._context.lineTo(1500,0),this._context.stroke(),this._context.restore()}drawImage(t,e={x:0,y:0},o=0,i={x:0,y:0}){this._context.save(),this._context.scale(this._scale.x,this._scale.y),this._context.translate(e.x,e.y),this._context.rotate(o),this._context.drawImage(t,0,0,t.width,t.height,-i.x,-i.y,t.width,t.height),this._context.restore()}drawBall(t,e={x:0,y:0},o,n,s){let r,a,c,l=48,u=48;if(s>8){l=50,u=50,c=-o.phi-Math.PI/2;const t=o.theta<0?2*Math.PI+o.theta:o.theta,e=Math.PI/41;let i=Math.round(t/e)+1;42===i&&(i=1),r=l*((i-1)%5),a=u*(Math.ceil(i/5)-1)}else r=l*(s%3),a=u*Math.floor(s/3);this._context.save(),this._context.scale(this._scale.x,this._scale.y),this._context.translate(e.x,e.y),s>8&&this._context.rotate(c),this._context.beginPath(),this._context.shadowColor="black",this._context.shadowOffsetX=(e.x-i.GameConfig.gameSize.x/2)/i.GameConfig.gameSize.x*25,this._context.shadowOffsetY=(e.y-i.GameConfig.gameSize.y/2)/i.GameConfig.gameSize.y*25,this._context.shadowBlur=8,this._context.arc(0,0,i.GameConfig.ball.diameter/2,0,2*Math.PI,!0),this._context.fill(),this._context.drawImage(t,r,a,l,u,-i.GameConfig.ball.diameter/2,-i.GameConfig.ball.diameter/2,i.GameConfig.ball.diameter,i.GameConfig.ball.diameter),this._context.restore(),this.drawSpot(e,o,n,s),this._context.save(),this._context.scale(this._scale.x,this._scale.y),this._context.translate(e.x,e.y),this._context.beginPath(),this._context.translate(-10,-10);const h=this._context.createRadialGradient(2,2,3,10,10,i.GameConfig.ball.diameter/2);h.addColorStop(0,"rgba(255,255,255,0.5)"),h.addColorStop(.7,"rgba(0,0,0,0.3)"),h.addColorStop(1,"rgba(0,0,0,0.8)"),this._context.fillStyle=h,this._context.arc(10,10,i.GameConfig.ball.diameter/2+1,0,2*Math.PI,!0),this._context.fill(),this._context.restore()}drawSpot(t={x:0,y:0},e,o,s){if(o.z>.08){const c=n.Assets.getSprite(i.GameConfig.sprites.paths.labelsSprite),l=s%4*38,u=38*Math.floor(s/4),{x:h,y:p,z:d}=o,_=a.getAtan(h,p),f=r.Orient.copy(e);f.rotateZ(-o.phi),f.rotateY(-o.theta);const y=f.phi+Math.PI,v=document.createElement("canvas");v.setAttribute("width",38..toString()),v.setAttribute("height",38..toString());const m=v.getContext("2d");m.translate(19,19),m.rotate(-y),m.drawImage(c,l,u,38,38,-19,-19,38,38);const g=.8*d+.2;this._context.save(),this._context.scale(this._scale.x,this._scale.y),this._context.translate(t.x+h*i.GameConfig.ball.diameter/2*.8,t.y-p*i.GameConfig.ball.diameter/2*.8),this._context.rotate(-_+Math.PI/2),this._context.drawImage(v,-10,-10*g,20,20*g),this._context.restore()}}drawText(t,e,o,i,n="left"){this._context.save(),this._context.scale(this._scale.x,this._scale.y),this._context.fillStyle=o,this._context.font=e,this._context.textAlign=n,this._context.fillText(t,i.x,i.y),this._context.restore()}changeCursor(t){this._canvas.style.cursor=t}}(c,l),window.addEventListener("resize",e.Canvas2D.resizeCanvas.bind(e.Canvas2D))},function(t,e,o){var i=o(66),n=o(72);t.exports=function(t,e){var o=n(t,e);return i(o)?o:void 0}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Assets=void 0;const i=o(0),n=i.GameConfig.sprites,s=i.GameConfig.sounds;e.Assets=new class{constructor(){this._sprites=new Map,this._sounds=new Map}loadSprite(t){const e=new Image;return this._sprites.set(t,e),new Promise(o=>{e.onload=()=>o(),e.src=n.basePath+t})}async loadGameSprites(){const t=Object.values(n.paths).map(this.loadSprite.bind(this));await Promise.all(t)}loadSound(t){const e=new Audio(s.basePath+t);return this._sounds.set(t,e),e.load(),new Promise(t=>{e.onloadeddata=()=>t()})}async loadGameSounds(){const t=Object.values(s.paths).map(this.loadSound.bind(this));await Promise.all(t)}async loadGameAssets(){await this.loadGameSounds(),await this.loadGameSprites()}getSprite(t){return this._sprites.get(t)}getSound(t){return this._sounds.get(t).cloneNode(!0)}playSound(t,e){if(i.GameConfig.soundOn){const o=this.getSound(t);o.volume=e,o.play()}}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector2=void 0;class i{constructor(t,e){this._x=t,this._y=e}get x(){return this._x}get y(){return this._y}static get zero(){return new i(0,0)}get length(){return Math.sqrt(Math.pow(this._x,2)+Math.pow(this._y,2))}static copy(t){return new i(t.x,t.y)}addX(t){return new i(this._x,this._y).addToX(t)}addY(t){return new i(this._x,this._y).addToY(t)}addToX(t){return this._x+=t,this}addToY(t){return this._y+=t,this}addTo(t){return this.addToX(t.x).addToY(t.y)}add(t){return new i(this._x,this._y).addTo(t)}subtractTo(t){return this._x-=t.x,this._y-=t.y,this}subtract(t){return new i(this._x,this._y).subtractTo(t)}mult(t){return new i(this._x,this._y).multBy(t)}multBy(t){return this._x*=t,this._y*=t,this}dot(t){return this._x*t.x+this._y*t.y}distFrom(t){return this.subtract(t).length}}e.Vector2=i},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mouse=void 0;const i=o(46),n=o(2),s=o(5);e.Mouse=new class{constructor(){this._buttonStates=[];for(let t=0;t<3;t++)this._buttonStates[t]=new i.ButtonState;this._position=s.Vector2.zero,document.addEventListener("mousemove",t=>this.handleMouseMove(t)),document.addEventListener("mousedown",t=>this.handleMouseDown(t)),document.addEventListener("mouseup",t=>this.handleMouseUp(t)),window.oncontextmenu=()=>!1}get position(){return s.Vector2.copy(this._position)}get pressedPosition(){return s.Vector2.copy(this._pressedPosition)}handleMouseMove(t){const e=(t.pageX-n.Canvas2D.offsetX)/n.Canvas2D.scaleX,o=(t.pageY-n.Canvas2D.offsetY)/n.Canvas2D.scaleY;this._position=new s.Vector2(e,o)}handleMouseDown(t){this._buttonStates[t.button].down=!0,this._buttonStates[t.button].released=!1,this._buttonStates[t.button].pressed=!0,this._pressedPosition=this._position}handleMouseUp(t){this._buttonStates[t.button].down=!1,this._buttonStates[t.button].released=!0}reset(){for(let t=0;t<3;t++)this._buttonStates[t].pressed=!1,this._buttonStates[t].released=!1}isDown(t){return this._buttonStates[t].down}isPressed(t){return this._buttonStates[t].pressed}isReleased(t){return this._buttonStates[t].released}}},function(t,e,o){var i=o(56),n=o(57),s=o(58),r=o(59),a=o(60);function c(t){var e=-1,o=null==t?0:t.length;for(this.clear();++e<o;){var i=t[e];this.set(i[0],i[1])}}c.prototype.clear=i,c.prototype.delete=n,c.prototype.get=s,c.prototype.has=r,c.prototype.set=a,t.exports=c},function(t,e,o){var i=o(30);t.exports=function(t,e){for(var o=t.length;o--;)if(i(t[o][0],e))return o;return-1}},function(t,e,o){var i=o(17),n=o(68),s=o(69),r=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":r&&r in Object(t)?n(t):s(t)}},function(t,e,o){var i=o(3)(Object,"create");t.exports=i},function(t,e,o){var i=o(82);t.exports=function(t,e){var o=t.__data__;return i(e)?o["string"==typeof e?"string":"hash"]:o.map}},function(t,e,o){var i=o(34),n=o(35);t.exports=function(t,e,o,s){var r=!o;o||(o={});for(var a=-1,c=e.length;++a<c;){var l=e[a],u=s?s(o[l],t[l],l,o,t):void 0;void 0===u&&(u=t[l]),r?n(o,l,u):i(o,l,u)}return o}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getAtan=e.mapRange=void 0,e.mapRange=(t,e,o,i,n)=>{let s=(t-e)*(n-i)/(o-e)+i;return s=s<i?i:s,s=s>n?n:s,s},e.getAtan=(t,e)=>{let o=Math.atan(e/t);return t<0&&(e<0?o-=Math.PI:o+=Math.PI),o}},function(t,e,o){var i=o(3)(o(1),"Map");t.exports=i},function(t,e,o){var i=o(1).Symbol;t.exports=i},function(t,e,o){var i=o(36),n=o(96),s=o(40);t.exports=function(t){return s(t)?i(t):n(t)}},function(t,e){var o=Array.isArray;t.exports=o},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,o){(function(t){var i=o(32),n=e&&!e.nodeType&&e,s=n&&"object"==typeof t&&t&&!t.nodeType&&t,r=s&&s.exports===n&&i.process,a=function(){try{var t=s&&s.require&&s.require("util").types;return t||r&&r.binding&&r.binding("util")}catch(t){}}();t.exports=a}).call(this,o(20)(t))},function(t,e){var o=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||o)}},function(t,e,o){var i=o(36),n=o(99),s=o(40);t.exports=function(t){return s(t)?i(t,!0):n(t)}},function(t,e,o){var i=o(104),n=o(41),s=Object.prototype.propertyIsEnumerable,r=Object.getOwnPropertySymbols,a=r?function(t){return null==t?[]:(t=Object(t),i(r(t),(function(e){return s.call(t,e)})))}:n;t.exports=a},function(t,e,o){var i=o(108),n=o(16),s=o(109),r=o(110),a=o(111),c=o(11),l=o(33),u=l(i),h=l(n),p=l(s),d=l(r),_=l(a),f=c;(i&&"[object DataView]"!=f(new i(new ArrayBuffer(1)))||n&&"[object Map]"!=f(new n)||s&&"[object Promise]"!=f(s.resolve())||r&&"[object Set]"!=f(new r)||a&&"[object WeakMap]"!=f(new a))&&(f=function(t){var e=c(t),o="[object Object]"==e?t.constructor:void 0,i=o?l(o):"";if(i)switch(i){case u:return"[object DataView]";case h:return"[object Map]";case p:return"[object Promise]";case d:return"[object Set]";case _:return"[object WeakMap]"}return e}),t.exports=f},function(t,e,o){var i=o(114);t.exports=function(t){var e=new t.constructor(t.byteLength);return new i(e).set(new i(t)),e}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AI=e.AITrainer=void 0;const i=o(5),n=o(0),s=o(51),r=o(52),a=o(53),c=o(8),l=n.GameConfig.ai,u=n.GameConfig.stick;class h{constructor(){this._iteration=0,this._finishedSession=!0,this._policy=new r.AIPolicy}get finishedSession(){return this._finishedSession}placeBallInHand(t){let e=i.Vector2.copy(n.GameConfig.cueBallPosition);for(;!t.isValidPosToPlaceCueBall(e);)e.addToX(5);t.placeBallInHand(e)}init(){this._opponents=[],this._currentOpponent=this.createRandomOpponent(),this._bestOpponent=this._currentOpponent,this._iteration=0}createMutation(t){let e=t.power;e+=2*Math.random()*l.shotPowerMutationVariance-l.shotPowerMutationVariance,e=e<l.minShotPower?l.minShotPower:e,e=e>u.maxPower?u.maxPower:e;let o=t.rotation;return t.evaluation>0?o+=1/t.evaluation*(2*Math.random()*Math.PI-Math.PI):o=2*Math.random()*Math.PI-Math.PI,new s.AIOpponent(e,o)}createRandomOpponent(){const t=75*Math.random()+1,e=2*Math.random()*Math.PI;return new s.AIOpponent(t,e)}train(){if(this._iteration===l.trainIterations)return n.GameConfig.soundOn=this._soundOnState,this.playTurn(),void(this._finishedSession=!0);if(this._gameWorld.isBallsMoving)return;this._gameWorld.concludeTurn(),this._currentOpponent.evaluation=this._policy.evaluate(this._gameWorld);const t=new s.AIOpponent(this._currentOpponent.power,this._currentOpponent.rotation,this._currentOpponent.evaluation);this._opponents.push(t),t.evaluation>this._bestOpponent.evaluation&&(this._bestOpponent=t),this._gameWorld=a(this._initialGameWorld),this._currentOpponent=this.buildNewOpponent(),this._iteration++,this.simulate()}buildNewOpponent(){return this._iteration%10==0?this.createRandomOpponent():this.createMutation(this._bestOpponent)}playTurn(){this._initialGameWorld.shootCueBall(this._bestOpponent.power,this._bestOpponent.rotation)}simulate(){this._gameWorld.shootCueBall(this._currentOpponent.power,this._currentOpponent.rotation)}opponentTrainingLoop(){for(;!this._finishedSession;)this.train(),this._gameWorld.update();c.Mouse.reset()}startSession(t){this._soundOnState=n.GameConfig.soundOn,n.GameConfig.soundOn=!1,t.isBallInHand&&this.placeBallInHand(t),this._initialGameWorld=t,this._gameWorld=a(t),this.init(),this._finishedSession=!1,this.simulate(),this.opponentTrainingLoop()}}e.AITrainer=h,e.AI=new h},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MenuActionType=void 0,function(t){t[t.CONTINUE=0]="CONTINUE",t[t.PVP=1]="PVP",t[t.PVC=2]="PVC",t[t.ToggleSound=3]="ToggleSound",t[t.GoToSubMenu=4]="GoToSubMenu",t[t.GoToPreviousMenu=5]="GoToPreviousMenu"}(e.MenuActionType||(e.MenuActionType={}))},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,o){var i=o(11),n=o(6);t.exports=function(t){if(!n(t))return!1;var e=i(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,o){(function(e){var o="object"==typeof e&&e&&e.Object===Object&&e;t.exports=o}).call(this,o(67))},function(t,e){var o=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return o.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,o){var i=o(35),n=o(30),s=Object.prototype.hasOwnProperty;t.exports=function(t,e,o){var r=t[e];s.call(t,e)&&n(r,o)&&(void 0!==o||e in t)||i(t,e,o)}},function(t,e,o){var i=o(87);t.exports=function(t,e,o){"__proto__"==e&&i?i(t,e,{configurable:!0,enumerable:!0,value:o,writable:!0}):t[e]=o}},function(t,e,o){var i=o(89),n=o(90),s=o(19),r=o(37),a=o(93),c=o(94),l=Object.prototype.hasOwnProperty;t.exports=function(t,e){var o=s(t),u=!o&&n(t),h=!o&&!u&&r(t),p=!o&&!u&&!h&&c(t),d=o||u||h||p,_=d?i(t.length,String):[],f=_.length;for(var y in t)!e&&!l.call(t,y)||d&&("length"==y||h&&("offset"==y||"parent"==y)||p&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||a(y,f))||_.push(y);return _}},function(t,e,o){(function(t){var i=o(1),n=o(92),s=e&&!e.nodeType&&e,r=s&&"object"==typeof t&&t&&!t.nodeType&&t,a=r&&r.exports===s?i.Buffer:void 0,c=(a?a.isBuffer:void 0)||n;t.exports=c}).call(this,o(20)(t))},function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e){t.exports=function(t,e){return function(o){return t(e(o))}}},function(t,e,o){var i=o(31),n=o(38);t.exports=function(t){return null!=t&&n(t.length)&&!i(t)}},function(t,e){t.exports=function(){return[]}},function(t,e,o){var i=o(43),n=o(44),s=o(25),r=o(41),a=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)i(e,s(t)),t=n(t);return e}:r;t.exports=a},function(t,e){t.exports=function(t,e){for(var o=-1,i=e.length,n=t.length;++o<i;)t[n+o]=e[o];return t}},function(t,e,o){var i=o(39)(Object.getPrototypeOf,Object);t.exports=i},function(t,e,o){var i=o(43),n=o(19);t.exports=function(t,e,o){var s=e(t);return n(t)?s:i(s,o(t))}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ButtonState=void 0;e.ButtonState=class{constructor(){this.down=!1,this.pressed=!1,this.released=!1}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Orient=void 0;const i=o(15);class n{constructor(t=0,e=0){this._phi=t,this._theta=e,this.toDecart()}get phi(){return this._phi}get theta(){return this._theta}static get zero(){return new n(0,0)}get x(){return this._x}get y(){return this._y}get z(){return this._z}set x(t){this._x=t}set y(t){this._y=t}set z(t){this._z=t}toDecart(){this._x=Math.sin(this._theta)*Math.cos(this._phi),this._y=Math.sin(this._theta)*Math.sin(this._phi),this._z=Math.cos(this._theta)}toSphere(){this._phi=i.getAtan(this._x,this._y),this._theta=Math.acos(this._z)}static copy(t){return new n(t.phi,t.theta)}rotate(t){this.rotateX(t.x),this.rotateY(t.y),this.rotateZ(t.z)}rotateX(t){const e=this._y;this._y=e*Math.cos(t)-this._z*Math.sin(t),this._z=e*Math.sin(t)+this._z*Math.cos(t),this.toSphere()}rotateY(t){const e=this._x;this._x=e*Math.cos(t)+this._z*Math.sin(t),this._z=-e*Math.sin(t)+this._z*Math.cos(t),this.toSphere()}rotateZ(t){const e=this._x;this._x=e*Math.cos(t)-this._y*Math.sin(t),this._y=e*Math.sin(t)+this._y*Math.cos(t),this.toSphere()}}e.Orient=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BallTypeEnum=e.Color=void 0,function(t){t.white="#BABABA",t.black="#2B2B2B",t.red="#B62A2F",t.yellow="#FECA34"}(e.Color||(e.Color={})),function(t){t[t.Unknown=0]="Unknown",t[t.Cue=1]="Cue",t[t.Stripe=2]="Stripe",t[t.Solid=3]="Solid",t[t.Eight=4]="Eight",t[t.Red=5]="Red",t[t.Color=6]="Color"}(e.BallTypeEnum||(e.BallTypeEnum={}))},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Keyboard=void 0;const i=o(46);e.Keyboard=new class{constructor(){this._keyStates=[];for(let t=0;t<256;t++)this._keyStates[t]=new i.ButtonState;document.addEventListener("keyup",t=>this.handleKeyUp(t)),document.addEventListener("keydown",t=>this.handleKeyDown(t))}handleKeyUp(t){this._keyStates[t.keyCode].down=!1}handleKeyDown(t){this._keyStates[t.keyCode].pressed=!0,this._keyStates[t.keyCode].down=!0}reset(){for(let t=0;t<256;t++)this._keyStates[t].pressed=!1}isDown(t){return this._keyStates[t].down}isPressed(t){return this._keyStates[t].pressed}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;const i=o(28),n=o(125),s=o(126),r=o(127),a=o(128),c=o(129),l=o(0),u=o(29),h=o(130),p=o(4),d=o(133),_=o(49),f=o(2),y=o(8),v=l.GameConfig.sprites,m=l.GameConfig.input;class g{constructor(){this._previousMenus=[],this._menu=new h.Menu}initMenuActions(){this._menuActionsMap=new Map,this._menuActionsMap.set(u.MenuActionType.PVP,new c.PVPCommand(this)),this._menuActionsMap.set(u.MenuActionType.PVC,new a.PVCCommand(this)),this._menuActionsMap.set(u.MenuActionType.ToggleSound,new r.ToggleSoundCommand),this._menuActionsMap.set(u.MenuActionType.GoToSubMenu,new s.GoToSubMenuCommand(this)),this._menuActionsMap.set(u.MenuActionType.GoToPreviousMenu,new n.GoToPreviousMenuCommand(this))}initMainMenu(){this._menu.init(this._menuActionsMap,l.GameConfig.mainMenu)}displayLoadingScreen(){return new Promise(t=>{this._isLoading=!0,f.Canvas2D.clear(),f.Canvas2D.drawImage(p.Assets.getSprite(v.paths.controls),l.GameConfig.loadingScreenImagePosition),setTimeout(()=>{this._isLoading=!1,t()},l.GameConfig.loadingScreenTimeout)})}handleInput(){this._inGame&&_.Keyboard.isPressed(m.toggleMenuKey)&&(this._menu.active?this._menu.active=!1:(this.initMainMenu(),this._menu.active=!0))}update(){this._isLoading||(this.handleInput(),this._menu.active?this._menu.update():this._poolGame.update(),_.Keyboard.reset(),y.Mouse.reset())}draw(){this._isLoading||i.AI.finishedSession&&(f.Canvas2D.clear(),this._menu.active?this._menu.draw():this._poolGame.draw())}gameLoop(){this.update(),this.draw(),window.requestAnimationFrame(()=>{this.gameLoop()})}async init(){await p.Assets.loadGameAssets(),this.initMenuActions(),this.initMainMenu(),this._menu.active=!0,this._poolGame=new d.GameWorld,this.gameLoop()}goToSubMenu(t){setTimeout(()=>{this._menu&&(this._menu.active=!1,this._previousMenus.push(this._menu)),this._menu=this._menu.getSubMenu(t),this._menu.active=!0},l.GameConfig.timeoutToLoadSubMenu)}goToPreviousMenu(){this._previousMenus.length>0&&setTimeout(()=>{this._menu.active=!1,this._menu=this._previousMenus.pop(),this._menu.active=!0},l.GameConfig.timeoutToLoadSubMenu)}start(){this.displayLoadingScreen().then(()=>{this._menu.active=!1,this._inGame=!0,this._poolGame=new d.GameWorld,this._poolGame.initMatch()})}}e.Game=g;(new g).init()},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AIOpponent=void 0;e.AIOpponent=class{constructor(t=50,e=0,o=0){this.power=t,this.rotation=e,this.evaluation=o}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AIPolicy=void 0;const i=o(0);e.AIPolicy=class{constructor(){}evaluate(t){let e=1;for(let o=0;o<t.balls.length;o++)for(let n=o+1;n<t.balls.length;n++){let s=t.balls[o],r=t.balls[n];e+=s.position.distFrom(r.position)*i.GameConfig.ai.ballDistanceBonus}return t.isTurnValid?(e+=i.GameConfig.ai.validTurnBonus,e+=i.GameConfig.ai.pocketedBallBonus*t.numOfPocketedBallsOnTurn,t.isGameOver&&(e+=i.GameConfig.ai.gameWonBonus)):(e-=i.GameConfig.ai.invalidTurnPenalty,t.isGameOver&&(e-=i.GameConfig.ai.gameLossPenalty)),e}}},function(t,e,o){var i=o(54);t.exports=function(t){return i(t,5)}},function(t,e,o){var i=o(55),n=o(86),s=o(34),r=o(88),a=o(98),c=o(101),l=o(102),u=o(103),h=o(105),p=o(106),d=o(107),_=o(26),f=o(112),y=o(113),v=o(119),m=o(19),g=o(37),b=o(121),x=o(6),w=o(123),P=o(18),M=o(24),C={};C["[object Arguments]"]=C["[object Array]"]=C["[object ArrayBuffer]"]=C["[object DataView]"]=C["[object Boolean]"]=C["[object Date]"]=C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Map]"]=C["[object Number]"]=C["[object Object]"]=C["[object RegExp]"]=C["[object Set]"]=C["[object String]"]=C["[object Symbol]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C["[object Error]"]=C["[object Function]"]=C["[object WeakMap]"]=!1,t.exports=function t(e,o,S,B,O,j){var T,G=1&o,A=2&o,I=4&o;if(S&&(T=O?S(e,B,O,j):S(e)),void 0!==T)return T;if(!x(e))return e;var k=m(e);if(k){if(T=f(e),!G)return l(e,T)}else{var V=_(e),H="[object Function]"==V||"[object GeneratorFunction]"==V;if(g(e))return c(e,G);if("[object Object]"==V||"[object Arguments]"==V||H&&!O){if(T=A||H?{}:v(e),!G)return A?h(e,a(T,e)):u(e,r(T,e))}else{if(!C[V])return O?e:{};T=y(e,V,G)}}j||(j=new i);var z=j.get(e);if(z)return z;j.set(e,T),w(e)?e.forEach((function(i){T.add(t(i,o,S,i,e,j))})):b(e)&&e.forEach((function(i,n){T.set(n,t(i,o,S,n,e,j))}));var D=k?void 0:(I?A?d:p:A?M:P)(e);return n(D||e,(function(i,n){D&&(i=e[n=i]),s(T,n,t(i,o,S,n,e,j))})),T}},function(t,e,o){var i=o(9),n=o(61),s=o(62),r=o(63),a=o(64),c=o(65);function l(t){var e=this.__data__=new i(t);this.size=e.size}l.prototype.clear=n,l.prototype.delete=s,l.prototype.get=r,l.prototype.has=a,l.prototype.set=c,t.exports=l},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,o){var i=o(10),n=Array.prototype.splice;t.exports=function(t){var e=this.__data__,o=i(e,t);return!(o<0)&&(o==e.length-1?e.pop():n.call(e,o,1),--this.size,!0)}},function(t,e,o){var i=o(10);t.exports=function(t){var e=this.__data__,o=i(e,t);return o<0?void 0:e[o][1]}},function(t,e,o){var i=o(10);t.exports=function(t){return i(this.__data__,t)>-1}},function(t,e,o){var i=o(10);t.exports=function(t,e){var o=this.__data__,n=i(o,t);return n<0?(++this.size,o.push([t,e])):o[n][1]=e,this}},function(t,e,o){var i=o(9);t.exports=function(){this.__data__=new i,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,o=e.delete(t);return this.size=e.size,o}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,o){var i=o(9),n=o(16),s=o(73);t.exports=function(t,e){var o=this.__data__;if(o instanceof i){var r=o.__data__;if(!n||r.length<199)return r.push([t,e]),this.size=++o.size,this;o=this.__data__=new s(r)}return o.set(t,e),this.size=o.size,this}},function(t,e,o){var i=o(31),n=o(70),s=o(6),r=o(33),a=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,u=c.toString,h=l.hasOwnProperty,p=RegExp("^"+u.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!s(t)||n(t))&&(i(t)?p:a).test(r(t))}},function(t,e){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(t){"object"==typeof window&&(o=window)}t.exports=o},function(t,e,o){var i=o(17),n=Object.prototype,s=n.hasOwnProperty,r=n.toString,a=i?i.toStringTag:void 0;t.exports=function(t){var e=s.call(t,a),o=t[a];try{t[a]=void 0;var i=!0}catch(t){}var n=r.call(t);return i&&(e?t[a]=o:delete t[a]),n}},function(t,e){var o=Object.prototype.toString;t.exports=function(t){return o.call(t)}},function(t,e,o){var i,n=o(71),s=(i=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";t.exports=function(t){return!!s&&s in t}},function(t,e,o){var i=o(1)["__core-js_shared__"];t.exports=i},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,o){var i=o(74),n=o(81),s=o(83),r=o(84),a=o(85);function c(t){var e=-1,o=null==t?0:t.length;for(this.clear();++e<o;){var i=t[e];this.set(i[0],i[1])}}c.prototype.clear=i,c.prototype.delete=n,c.prototype.get=s,c.prototype.has=r,c.prototype.set=a,t.exports=c},function(t,e,o){var i=o(75),n=o(9),s=o(16);t.exports=function(){this.size=0,this.__data__={hash:new i,map:new(s||n),string:new i}}},function(t,e,o){var i=o(76),n=o(77),s=o(78),r=o(79),a=o(80);function c(t){var e=-1,o=null==t?0:t.length;for(this.clear();++e<o;){var i=t[e];this.set(i[0],i[1])}}c.prototype.clear=i,c.prototype.delete=n,c.prototype.get=s,c.prototype.has=r,c.prototype.set=a,t.exports=c},function(t,e,o){var i=o(12);t.exports=function(){this.__data__=i?i(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,o){var i=o(12),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(i){var o=e[t];return"__lodash_hash_undefined__"===o?void 0:o}return n.call(e,t)?e[t]:void 0}},function(t,e,o){var i=o(12),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return i?void 0!==e[t]:n.call(e,t)}},function(t,e,o){var i=o(12);t.exports=function(t,e){var o=this.__data__;return this.size+=this.has(t)?0:1,o[t]=i&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,o){var i=o(13);t.exports=function(t){var e=i(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,o){var i=o(13);t.exports=function(t){return i(this,t).get(t)}},function(t,e,o){var i=o(13);t.exports=function(t){return i(this,t).has(t)}},function(t,e,o){var i=o(13);t.exports=function(t,e){var o=i(this,t),n=o.size;return o.set(t,e),this.size+=o.size==n?0:1,this}},function(t,e){t.exports=function(t,e){for(var o=-1,i=null==t?0:t.length;++o<i&&!1!==e(t[o],o,t););return t}},function(t,e,o){var i=o(3),n=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=n},function(t,e,o){var i=o(14),n=o(18);t.exports=function(t,e){return t&&i(e,n(e),t)}},function(t,e){t.exports=function(t,e){for(var o=-1,i=Array(t);++o<t;)i[o]=e(o);return i}},function(t,e,o){var i=o(91),n=o(7),s=Object.prototype,r=s.hasOwnProperty,a=s.propertyIsEnumerable,c=i(function(){return arguments}())?i:function(t){return n(t)&&r.call(t,"callee")&&!a.call(t,"callee")};t.exports=c},function(t,e,o){var i=o(11),n=o(7);t.exports=function(t){return n(t)&&"[object Arguments]"==i(t)}},function(t,e){t.exports=function(){return!1}},function(t,e){var o=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&o.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,o){var i=o(95),n=o(21),s=o(22),r=s&&s.isTypedArray,a=r?n(r):i;t.exports=a},function(t,e,o){var i=o(11),n=o(38),s=o(7),r={};r["[object Float32Array]"]=r["[object Float64Array]"]=r["[object Int8Array]"]=r["[object Int16Array]"]=r["[object Int32Array]"]=r["[object Uint8Array]"]=r["[object Uint8ClampedArray]"]=r["[object Uint16Array]"]=r["[object Uint32Array]"]=!0,r["[object Arguments]"]=r["[object Array]"]=r["[object ArrayBuffer]"]=r["[object Boolean]"]=r["[object DataView]"]=r["[object Date]"]=r["[object Error]"]=r["[object Function]"]=r["[object Map]"]=r["[object Number]"]=r["[object Object]"]=r["[object RegExp]"]=r["[object Set]"]=r["[object String]"]=r["[object WeakMap]"]=!1,t.exports=function(t){return s(t)&&n(t.length)&&!!r[i(t)]}},function(t,e,o){var i=o(23),n=o(97),s=Object.prototype.hasOwnProperty;t.exports=function(t){if(!i(t))return n(t);var e=[];for(var o in Object(t))s.call(t,o)&&"constructor"!=o&&e.push(o);return e}},function(t,e,o){var i=o(39)(Object.keys,Object);t.exports=i},function(t,e,o){var i=o(14),n=o(24);t.exports=function(t,e){return t&&i(e,n(e),t)}},function(t,e,o){var i=o(6),n=o(23),s=o(100),r=Object.prototype.hasOwnProperty;t.exports=function(t){if(!i(t))return s(t);var e=n(t),o=[];for(var a in t)("constructor"!=a||!e&&r.call(t,a))&&o.push(a);return o}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var o in Object(t))e.push(o);return e}},function(t,e,o){(function(t){var i=o(1),n=e&&!e.nodeType&&e,s=n&&"object"==typeof t&&t&&!t.nodeType&&t,r=s&&s.exports===n?i.Buffer:void 0,a=r?r.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var o=t.length,i=a?a(o):new t.constructor(o);return t.copy(i),i}}).call(this,o(20)(t))},function(t,e){t.exports=function(t,e){var o=-1,i=t.length;for(e||(e=Array(i));++o<i;)e[o]=t[o];return e}},function(t,e,o){var i=o(14),n=o(25);t.exports=function(t,e){return i(t,n(t),e)}},function(t,e){t.exports=function(t,e){for(var o=-1,i=null==t?0:t.length,n=0,s=[];++o<i;){var r=t[o];e(r,o,t)&&(s[n++]=r)}return s}},function(t,e,o){var i=o(14),n=o(42);t.exports=function(t,e){return i(t,n(t),e)}},function(t,e,o){var i=o(45),n=o(25),s=o(18);t.exports=function(t){return i(t,s,n)}},function(t,e,o){var i=o(45),n=o(42),s=o(24);t.exports=function(t){return i(t,s,n)}},function(t,e,o){var i=o(3)(o(1),"DataView");t.exports=i},function(t,e,o){var i=o(3)(o(1),"Promise");t.exports=i},function(t,e,o){var i=o(3)(o(1),"Set");t.exports=i},function(t,e,o){var i=o(3)(o(1),"WeakMap");t.exports=i},function(t,e){var o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&o.call(t,"index")&&(i.index=t.index,i.input=t.input),i}},function(t,e,o){var i=o(27),n=o(115),s=o(116),r=o(117),a=o(118);t.exports=function(t,e,o){var c=t.constructor;switch(e){case"[object ArrayBuffer]":return i(t);case"[object Boolean]":case"[object Date]":return new c(+t);case"[object DataView]":return n(t,o);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(t,o);case"[object Map]":return new c;case"[object Number]":case"[object String]":return new c(t);case"[object RegExp]":return s(t);case"[object Set]":return new c;case"[object Symbol]":return r(t)}}},function(t,e,o){var i=o(1).Uint8Array;t.exports=i},function(t,e,o){var i=o(27);t.exports=function(t,e){var o=e?i(t.buffer):t.buffer;return new t.constructor(o,t.byteOffset,t.byteLength)}},function(t,e){var o=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,o.exec(t));return e.lastIndex=t.lastIndex,e}},function(t,e,o){var i=o(17),n=i?i.prototype:void 0,s=n?n.valueOf:void 0;t.exports=function(t){return s?Object(s.call(t)):{}}},function(t,e,o){var i=o(27);t.exports=function(t,e){var o=e?i(t.buffer):t.buffer;return new t.constructor(o,t.byteOffset,t.length)}},function(t,e,o){var i=o(120),n=o(44),s=o(23);t.exports=function(t){return"function"!=typeof t.constructor||s(t)?{}:i(n(t))}},function(t,e,o){var i=o(6),n=Object.create,s=function(){function t(){}return function(e){if(!i(e))return{};if(n)return n(e);t.prototype=e;var o=new t;return t.prototype=void 0,o}}();t.exports=s},function(t,e,o){var i=o(122),n=o(21),s=o(22),r=s&&s.isMap,a=r?n(r):i;t.exports=a},function(t,e,o){var i=o(26),n=o(7);t.exports=function(t){return n(t)&&"[object Map]"==i(t)}},function(t,e,o){var i=o(124),n=o(21),s=o(22),r=s&&s.isSet,a=r?n(r):i;t.exports=a},function(t,e,o){var i=o(26),n=o(7);t.exports=function(t){return n(t)&&"[object Set]"==i(t)}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GoToPreviousMenuCommand=void 0;e.GoToPreviousMenuCommand=class{constructor(t){this._game=t}execute(){this._game.goToPreviousMenu()}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GoToSubMenuCommand=void 0;e.GoToSubMenuCommand=class{constructor(t){this._game=t}execute(t){this._game.goToSubMenu(t)}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ToggleSoundCommand=void 0;const i=o(0),n=i.GameConfig.sprites;e.ToggleSoundCommand=class{toggleMuteButtonSprite(){const t=n.paths.muteButton,e=n.paths.muteButtonHovered;n.paths.muteButton=n.paths.muteButtonPressed,n.paths.muteButtonHovered=n.paths.muteButtonPressedHovered,n.paths.muteButtonPressed=t,n.paths.muteButtonPressedHovered=e}execute(){i.GameConfig.soundOn=!i.GameConfig.soundOn,this.toggleMuteButtonSprite()}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PVCCommand=void 0;const i=o(0);e.PVCCommand=class{constructor(t){this._game=t}execute(t){i.GameConfig.ai.playerIndex=Math.floor(2*Math.random()),i.GameConfig.ai.on=!0,i.GameConfig.ai.trainIterations=t,this._game.start()}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PVPCommand=void 0;const i=o(0);e.PVPCommand=class{constructor(t){this._game=t}execute(){i.GameConfig.ai.on=!1,this._game.start()}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Menu=void 0;const i=o(131),n=o(4),s=o(2),r=o(0),a=o(132),c=r.GameConfig.cursor,l=r.GameConfig.sprites;class u{set active(t){this._active=t}get active(){return this._active}init(t,e){this._buttons=e.buttons.map(e=>new i.MenuButton(t.get(e.action),e.value,e.position,e.sprite,e.spriteOnHover)),this._labels=e.labels.map(t=>new a.MenuLabel(t.text,t.position,t.font,t.color,t.alignment)),this._subMenus=e.subMenus.map(e=>{const o=new u;return o.init(t,e),o})}getSubMenu(t){return this._subMenus[t]}update(){this._active&&this._buttons.forEach(t=>t.update()),this._subMenus.forEach(t=>t.update())}draw(){this._active&&(s.Canvas2D.changeCursor(c.default),s.Canvas2D.drawImage(n.Assets.getSprite(l.paths.menuBackground)),this._labels.forEach(t=>t.draw()),this._buttons.forEach(t=>t.draw())),this._subMenus.forEach(t=>t.draw())}}e.Menu=u},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MenuButton=void 0;const i=o(0),n=o(8),s=o(2),r=o(4),a=i.GameConfig.input,c=i.GameConfig.cursor,l=i.GameConfig.sprites;e.MenuButton=class{constructor(t,e,o,i,n){this._command=t,this._value=e,this._position=o,this._spriteKey=i,this._spriteOnHoverKey=n,this._activeSprite=r.Assets.getSprite(l.paths[this._spriteKey])}set hovered(t){this._hovered=t}isInsideButton(t){return t.x>this._position.x&&t.x<this._position.x+this._activeSprite.width&&t.y>this._position.y&&t.y<this._position.y+this._activeSprite.height}handleInput(){this.hovered=this.isInsideButton(n.Mouse.position),this._activeSprite=this._hovered?r.Assets.getSprite(l.paths[this._spriteOnHoverKey]):r.Assets.getSprite(l.paths[this._spriteKey]),this._hovered&&n.Mouse.isPressed(a.mouseSelectButton)&&(s.Canvas2D.changeCursor(c.default),this._command.execute(this._value))}update(){this.handleInput()}draw(){this._hovered&&s.Canvas2D.changeCursor(c.button),s.Canvas2D.drawImage(this._activeSprite,this._position)}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MenuLabel=void 0;const i=o(2);e.MenuLabel=class{constructor(t,e,o,i,n){this._text=t,this._position=e,this._font=o,this._color=i,this._alignment=n}draw(){i.Canvas2D.drawText(this._text,this._font,this._color,this._position,this._alignment)}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GameWorld=void 0;const i=o(28),n=o(15),s=o(134),r=o(135),a=o(136),c=o(48),l=o(5),u=o(0),h=o(4),p=o(2),d=o(137),_=o(8),f=o(138),y=u.GameConfig.physics,v=u.GameConfig.input,m=u.GameConfig.ball,g=u.GameConfig.table,b=u.GameConfig.labels,x=u.GameConfig.matchScore,w=u.GameConfig.ai,P=u.GameConfig.gameSize,M=u.GameConfig.sprites,C=u.GameConfig.sounds;e.GameWorld=class{constructor(){this._players=[new r.Player,new r.Player],this._currentPlayerIndex=0,this.initMatch()}get currentPlayer(){return this._players[this._currentPlayerIndex]}get nextPlayer(){return this._players[(this._currentPlayerIndex+1)%this._players.length]}get balls(){return this._balls}get isBallInHand(){return this._turnState.ballInHand}get isTurnValid(){return this._turnState.isValid}get isGameOver(){return this._referee.isGameOver(this.currentPlayer,this._cueBall,this._8Ball)}get isBallsMoving(){return this._balls.some(t=>t.moving)}get numOfPocketedBallsOnTurn(){return this._turnState.pocketedBalls.length}getBallsByColor(t){return this._balls.filter(e=>e.color===t)}handleInput(){i.AI.finishedSession&&_.Mouse.isDown(v.mouseShootButton)&&this._stick.shot&&this.shootCueBall(this._stick.power,this._stick.rotation)}isBallPosOutsideTopBorder(t){return t.y-m.diameter/2<=g.cushionWidth}isBallPosOutsideLeftBorder(t){return t.x-m.diameter/2<=g.cushionWidth}isBallPosOutsideRightBorder(t){return t.x+m.diameter/2>=P.x-g.cushionWidth}isBallPosOutsideBottomBorder(t){return t.y+m.diameter/2>=P.y-g.cushionWidth}handleCollisionWithTopCushion(t){t.position=t.position.addY(g.cushionWidth-t.position.y+m.diameter/2),t.velocity=new l.Vector2(t.velocity.x,-t.velocity.y)}handleCollisionWithLeftCushion(t){t.position=t.position.addX(g.cushionWidth-t.position.x+m.diameter/2),t.velocity=new l.Vector2(-t.velocity.x,t.velocity.y)}handleCollisionWithRightCushion(t){t.position=t.position.addX(P.x-g.cushionWidth-t.position.x-m.diameter/2),t.velocity=new l.Vector2(-t.velocity.x,t.velocity.y)}handleCollisionWithBottomCushion(t){t.position=t.position.addY(P.y-g.cushionWidth-t.position.y-m.diameter/2),t.velocity=new l.Vector2(t.velocity.x,-t.velocity.y)}resolveBallCollisionWithCushion(t){let e=!1;this.isBallPosOutsideTopBorder(t.nextPosition)&&(this.handleCollisionWithTopCushion(t),e=!0),this.isBallPosOutsideLeftBorder(t.nextPosition)&&(this.handleCollisionWithLeftCushion(t),e=!0),this.isBallPosOutsideRightBorder(t.nextPosition)&&(this.handleCollisionWithRightCushion(t),e=!0),this.isBallPosOutsideBottomBorder(t.nextPosition)&&(this.handleCollisionWithBottomCushion(t),e=!0),e&&(t.velocity=t.velocity.mult(1-y.collisionLoss))}resolveBallsCollision(t,e){if(!t.visible||!e.visible)return!1;const o=t.position.subtract(e.position),i=o.length;if(i>m.diameter)return!1;const n=o.mult((m.diameter-i)/i);t.position=t.position.add(n.mult(.5)),e.position=e.position.subtract(n.mult(.5));const s=o.mult(1/o.length),r=new l.Vector2(-s.y,s.x),a=s.dot(t.velocity),c=r.dot(t.velocity),u=s.dot(e.velocity),h=r.dot(e.velocity),p=s.mult(u),d=r.mult(c),_=s.mult(a),f=r.mult(h),v=Math.atan2(t.velocity.y,t.velocity.x)+Math.PI/2,g=Math.atan2(e.velocity.y,e.velocity.x)+Math.PI/2,b=t.rotation.z*m.diameter/2*y.rotationToVelocity,x=e.rotation.z*m.diameter/2*y.rotationToVelocity,w=new l.Vector2(b*Math.cos(v),b*Math.sin(v)),P=new l.Vector2(x*Math.cos(g),x*Math.sin(g)),M=t.rotation.y*m.diameter/2*y.rotationToVelocity,C=t.rotation.x*m.diameter/2*y.rotationToVelocity,S=e.rotation.y*m.diameter/2*y.rotationToVelocity,B=e.rotation.x*m.diameter/2*y.rotationToVelocity,O=new l.Vector2(M,C),j=new l.Vector2(S,B);return t.velocity=p.add(d),e.velocity=_.add(f),w.length&&(t.velocity=t.velocity.add(w)),P.length&&(e.velocity=e.velocity.add(P)),t.velocity=t.velocity.add(O),e.velocity=e.velocity.add(j),t.velocity=t.velocity.mult(1-y.collisionLoss),e.velocity=e.velocity.mult(1-y.collisionLoss),t.rotation={x:0,y:0,z:0},e.rotation={x:0,y:0,z:0},!0}handleCollisions(){for(let t=0;t<this._balls.length;t++){this.resolveBallCollisionWithCushion(this._balls[t]);for(let e=t+1;e<this._balls.length;e++){const o=this._balls[t],i=this._balls[e];if(this.resolveBallsCollision(o,i)){const t=o.velocity.length+i.velocity.length,e=n.mapRange(t,0,m.maxExpectedCollisionForce,0,1);if(h.Assets.playSound(C.paths.ballsCollide,e),!this._turnState.firstCollidedBallColor){const t=o.color===c.Color.white?i.color:o.color;this._turnState.firstCollidedBallColor=t}}}}}isInsidePocket(t){return g.pocketsPositions.some(e=>t.distFrom(e)<=g.pocketRadius)}resolveBallInPocket(t){this.isInsidePocket(t.position)&&t.hide()}isValidPlayerColor(t){return t===c.Color.red||t===c.Color.yellow}handleBallsInPockets(){this._balls.forEach(t=>{this.resolveBallInPocket(t),t.visible||this._turnState.pocketedBalls.includes(t)||(h.Assets.playSound(C.paths.rail,1),!this.currentPlayer.color&&this.isValidPlayerColor(t.color)&&(this.currentPlayer.color=t.color,this.nextPlayer.color=t.color===c.Color.yellow?c.Color.red:c.Color.yellow),this._turnState.pocketedBalls.push(t))})}handleBallInHand(){_.Mouse.isPressed(v.mousePlaceBallButton)&&this.isValidPosToPlaceCueBall(_.Mouse.position)?this.placeBallInHand(_.Mouse.position):(this._stick.movable=!1,this._stick.visible=!1,this._cueBall.position=_.Mouse.position)}handleGameOver(){this._turnState.isValid?this.currentPlayer.overallScore++:this.nextPlayer.overallScore++,this.initMatch()}nextTurn(){const t=!this._turnState.isValid;this.isGameOver?this.handleGameOver():(this._cueBall.visible||this._cueBall.show(l.Vector2.copy(u.GameConfig.cueBallPosition)),(t||0===this._turnState.pocketedBalls.length)&&(this._currentPlayerIndex++,this._currentPlayerIndex=this._currentPlayerIndex%this._players.length),this._stick.show(this._cueBall.position),this._turnState=new f.State,this._turnState.ballInHand=t,this.isAITurn()&&i.AI.startSession(this))}drawCurrentPlayerLabel(){p.Canvas2D.drawText(b.currentPlayer.text+(this._currentPlayerIndex+1),b.currentPlayer.font,b.currentPlayer.color,b.currentPlayer.position,b.currentPlayer.alignment)}drawMatchScores(){for(let t=0;t<this._players.length;t++)for(let e=0;e<this._players[t].matchScore;e++){const o=l.Vector2.copy(x.scoresPositions[t]).addToX(e*x.unitMargin),i=this._players[t].color===c.Color.red?h.Assets.getSprite(M.paths.redScore):h.Assets.getSprite(M.paths.yellowScore);p.Canvas2D.drawImage(i,o)}}drawHitMenu(){const t=h.Assets.getSprite(M.paths.hitMarker);p.Canvas2D.drawImage(t,u.GameConfig.hitMarketPosition,0)}drawOverallScores(){for(let t=0;t<this._players.length;t++)p.Canvas2D.drawText(this._players[t].overallScore.toString(),b.overalScores[t].font,b.overalScores[t].color,b.overalScores[t].position,b.overalScores[t].alignment)}isInsideTableBoundaries(t){let e=!this.isInsidePocket(t);return e=e&&!this.isBallPosOutsideTopBorder(t),e=e&&!this.isBallPosOutsideLeftBorder(t),e=e&&!this.isBallPosOutsideRightBorder(t),e=e&&!this.isBallPosOutsideBottomBorder(t),e}isAITurn(){return i.AI.finishedSession&&w.on&&this._currentPlayerIndex===w.playerIndex}createNumberedBalls(){this._8Ball=new d.Ball(l.Vector2.copy(u.GameConfig.eightBallPosition),c.Color.black,c.BallTypeEnum.Eight,8),this._cueBall=new d.Ball(l.Vector2.copy(u.GameConfig.cueBallPosition),c.Color.white,c.BallTypeEnum.Cue,0);const t=u.GameConfig.redBallsPositions.map((t,e)=>new d.Ball(l.Vector2.copy(t),c.Color.red,c.BallTypeEnum.Solid,e+1)),e=u.GameConfig.yellowBallsPositions.map((t,e)=>new d.Ball(l.Vector2.copy(t),c.Color.yellow,c.BallTypeEnum.Stripe,e+9));this._balls=[this._cueBall,...t,this._8Ball,...e]}initMatch(){this._stick=new a.Stick(l.Vector2.copy(u.GameConfig.cueBallPosition)),this.createNumberedBalls(),this._currentPlayerIndex=0,this._players.forEach(t=>{t.matchScore=0,t.color=null}),this._turnState=new f.State,this._referee=new s.Referee,this.isAITurn()&&i.AI.startSession(this)}isValidPosToPlaceCueBall(t){return this._balls.every(e=>e.color===c.Color.white||e.position.distFrom(t)>m.diameter)&&this.isInsideTableBoundaries(t)}placeBallInHand(t){this._cueBall.position=t,this._turnState.ballInHand=!1,this._stick.show(this._cueBall.position)}concludeTurn(){this._turnState.pocketedBalls.forEach(t=>{const e=this._balls.indexOf(t);t.color!=c.Color.white&&this._balls.splice(e,1)}),this.currentPlayer.color&&(this.currentPlayer.matchScore=8-this.getBallsByColor(this.currentPlayer.color).length-this.getBallsByColor(c.Color.black).length),this.nextPlayer.color&&(this.nextPlayer.matchScore=8-this.getBallsByColor(this.nextPlayer.color).length-this.getBallsByColor(c.Color.black).length),this._turnState.isValid=this._referee.isValidTurn(this.currentPlayer,this._turnState)}shootCueBall(t,e){t>0&&(this._stick.rotation=e,this._stick.shoot(),this._cueBall.shoot(t,e,this._stick.hitPosition),this._stick.movable=!1,this._stick.shot=!1,setTimeout(()=>this._stick.hide(),u.GameConfig.timeoutToHideStickAfterShot))}update(){this.isBallInHand?this.handleBallInHand():(this.handleBallsInPockets(),this.handleCollisions(),this.handleInput(),this._stick.update(),this._balls.forEach(t=>t.update()),this.isBallsMoving||this._stick.visible||(this.concludeTurn(),this.nextTurn()))}draw(){p.Canvas2D.drawImage(h.Assets.getSprite(M.paths.table)),this.drawCurrentPlayerLabel(),this.drawMatchScores(),this.drawOverallScores(),this.drawHitMenu(),p.Canvas2D.drawPowerGraph(),this._balls.forEach(t=>t.draw()),this._stick.draw()}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Referee=void 0;const i=o(48);e.Referee=class{isValidFirstTouch(t,e,o){return!!e&&(t.color?t.color===e||1===t.matchScore&&o&&e!==i.Color.black||7===t.matchScore&&e===i.Color.black||8===t.matchScore&&e===i.Color.black:e!==i.Color.black)}isValidPocketedBalls(t,e){if(0===e.length)return!0;if(t.color)return 8===t.matchScore?1===e.length&&e[0].color===i.Color.black:e.every(e=>e.color===t.color);{const t=e[0].color;return t!==i.Color.white&&t!==i.Color.black&&e.every(e=>e.color===t)}}isValidTurn(t,e){return this.isValidFirstTouch(t,e.firstCollidedBallColor,e.pocketedBalls.length>0)&&this.isValidPocketedBalls(t,e.pocketedBalls)}isGameOver(t,e,o){return!o.visible||!e.visible&&7===t.matchScore||!e.visible&&8===t.matchScore}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Player=void 0;e.Player=class{constructor(){this.matchScore=0,this.overallScore=0}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Stick=void 0;const i=o(49),n=o(8),s=o(0),r=o(4),a=o(2),c=o(5),l=o(15),u=s.GameConfig.input,h=s.GameConfig.stick,p=s.GameConfig.sprites,d=s.GameConfig.sounds;e.Stick=class{constructor(t){this._position=t,this._sprite=r.Assets.getSprite(p.paths.stick),this._rotation=0,this._origin=c.Vector2.copy(h.origin),this._power=0,this._movable=!0,this._visible=!0,this._hitPosition=c.Vector2.zero,this._shot=!1,this._wasDrawn=!1,this._showHitLine=!0,this._prevOffset=c.Vector2.zero,this._prevTime=0,this._prevMousePosition=c.Vector2.zero}get position(){return c.Vector2.copy(this._position)}get rotation(){return this._rotation}get power(){return this._power}get shot(){return this._shot}get visible(){return this._visible}get hitPosition(){return this._hitPosition}set shot(t){this._shot=t}set movable(t){this._movable=t}set visible(t){this._visible=t}set rotation(t){this._rotation=t}updateOffset(){const t=n.Mouse.position.subtract(n.Mouse.pressedPosition);let e=-(t.x*Math.cos(this._rotation)+t.y*Math.sin(this._rotation));e>3&&(this._wasDrawn=!0),e>h.maxPower&&(e=h.maxPower),e<0&&(this._wasDrawn?e<-5&&(e=-5,this._wasDrawn&&(this._shot=!0,this._wasDrawn=!1)):e=0),this._origin=c.Vector2.copy(h.origin).addX(4*e)}updateSpeed(){const t=n.Mouse.position.subtract(n.Mouse.pressedPosition);if(0!=this._prevTime&&this._prevOffset.length>0){const e=Date.now(),o=t.subtract(this._prevOffset),i=o.x*Math.cos(this._rotation)+o.y*Math.sin(this._rotation);i<=0?this._power=0:(this._power=i/(e-this._prevTime)*200,this._power>h.maxPower&&(this._power=h.maxPower))}this._prevOffset=t}resetSpeed(){this._prevOffset=c.Vector2.zero,this._prevTime=0,this._origin=c.Vector2.copy(h.origin),this._wasDrawn=!1}initSpeed(){this._prevOffset=n.Mouse.position.subtract(n.Mouse.pressedPosition),this._prevTime=Date.now(),this._power=0}updatePower(){n.Mouse.isDown(u.mouseShootButton)&&(this.updateOffset(),this.updateSpeed()),n.Mouse.isPressed(u.mouseShootButton)&&this.initSpeed(),n.Mouse.isReleased(u.mouseShootButton)&&this.resetSpeed()}updateHitPosition(){if(!n.Mouse.isDown(u.mouseShootButton)){const{x:t,y:e}=this._hitPosition;let o=t,n=e;i.Keyboard.isPressed(u.upHitKey)&&(n=Math.abs(e+.1)>Math.sqrt(1-t*t)?Math.sqrt(1-t*t):e+.1),i.Keyboard.isPressed(u.downHitKey)&&(n=Math.abs(e-.1)>Math.sqrt(1-t*t)?-Math.sqrt(1-t*t):e-.1),i.Keyboard.isPressed(u.rightHitKey)&&(o=Math.abs(t+.1)>Math.sqrt(1-e*e)?Math.sqrt(1-e*e):t+.1),i.Keyboard.isPressed(u.leftHitKey)&&(o=Math.abs(t-.1)>Math.sqrt(1-e*e)?-Math.sqrt(1-e*e):t-.1),this._hitPosition=new c.Vector2(o,n),this._hitOrigin=-t*s.GameConfig.ball.diameter/2*.9}}setHitMarker(){const t=s.GameConfig.hitMarketDiameter/2,e=(n.Mouse.position.x-s.GameConfig.hitMarketPosition.x-t)/t,o=(n.Mouse.position.y-s.GameConfig.hitMarketPosition.y-t)/t;Math.sqrt(e*e+o*o)<=1&&(this._hitPosition=new c.Vector2(e,-o))}updateRotation(){if(n.Mouse.isDown(u.mouseShootButton))this.setHitMarker(),this._prevMousePosition=c.Vector2.copy(n.Mouse.position);else if(this._prevMousePosition.subtract(n.Mouse.position).length>.01){const t=n.Mouse.position.y-this._position.y,e=n.Mouse.position.x-this._position.x;this._rotation=Math.atan2(t,e),this._prevMousePosition=n.Mouse.position,this._visible&&n.Mouse.isPressed(u.mouseToggleHitlineButton)&&(this._showHitLine=!this._showHitLine),this._prevMousePosition=c.Vector2.zero}}resetCue(){this.resetSpeed(),this._hitPosition=c.Vector2.zero,this._hitOrigin=0}hide(){this._visible=!1,this._movable=!1,this.resetCue()}show(t){this._power=0,this._position=t,this._origin=c.Vector2.copy(h.origin),this._movable=!0,this._visible=!0}shoot(){this._origin=c.Vector2.copy(h.shotOrigin);const t=l.mapRange(this._power,0,h.maxPower,0,1);r.Assets.playSound(d.paths.strike,t)}update(){this._movable&&(this.updateRotation(),this.updateHitPosition(),this.updatePower())}draw(){this._visible&&(a.Canvas2D.drawImage(this._sprite,this._position,this._rotation,this._origin.addY(this._hitOrigin)),this._movable&&(a.Canvas2D.drawHitPosition(this._hitPosition),this._showHitLine&&a.Canvas2D.drawHitLine(this._position,this._rotation))),this._movable||a.Canvas2D.drawHitPower(this._power)}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ball=void 0;const i=o(0),n=o(2),s=o(5),r=o(4),a=o(47),c=i.GameConfig.physics,l=i.GameConfig.sprites,u=i.GameConfig.ball;e.Ball=class{constructor(t,e,o,i){this._position=t,this._velocity=s.Vector2.zero,this._moving=!1,this._visible=!0,this._rotation={x:0,y:0,z:0},this._color=e,this._type=o,this._number=i,this._orientation=new a.Orient,this._labelOrient=new a.Orient(0,Math.PI/2);const n=2*Math.random()*Math.PI-Math.PI,r=2*Math.random()*Math.PI-Math.PI;this._orientation.rotateX(n),this._orientation.rotateY(r),this._labelOrient.rotateX(n),this._labelOrient.rotateY(r),this.resolveSprite(e)}get position(){return s.Vector2.copy(this._position)}set position(t){this._position=t}get nextPosition(){return this.position.add(this._velocity.mult(1-c.friction))}get velocity(){return s.Vector2.copy(this._velocity)}set velocity(t){this._moving=t.length>0,this._velocity=t}set rotation(t){this._rotation=t}get rotation(){return this._rotation}get moving(){return this._moving}get color(){return this._color}get type(){return this._type}get number(){return this._number}get orientaion(){return this._orientation}get visible(){return this._visible}resolveSprite(t){this._number>8?this._sprite=r.Assets.getSprite(l.paths["ball"+this._number]):this._sprite=r.Assets.getSprite(l.paths.solidBalls)}shoot(t,e,o){this._velocity=new s.Vector2(t*Math.cos(e),t*Math.sin(e));const n=t*o.y*i.GameConfig.physics.powerToRotationRatio;this._rotation={x:n*Math.sin(e),y:n*Math.cos(e),z:t*o.x*i.GameConfig.physics.powerToRotationRatio},this._moving=!0}show(t){this._position=t,this._velocity=s.Vector2.zero,this._rotation={x:0,y:0,z:0},this._visible=!0}hide(){this._velocity=s.Vector2.zero,this._rotation={x:0,y:0,z:0},this._moving=!1,this._visible=!1}update(){if(this._moving){this._velocity.multBy(1-c.friction),this._position.addTo(this._velocity);const t=i.GameConfig.physics.rotationFriction,e=i.GameConfig.physics.counterRotationFriction;this._rotation.x*=Math.sign(this._velocity.y)===Math.sign(this._rotation.x)?1-t:1-e,this._rotation.y*=Math.sign(this._velocity.x)===Math.sign(this._rotation.y)?1-t:1-e,this._rotation.z*=1-t;const o=2*this._velocity.y/i.GameConfig.ball.diameter+this._rotation.x,n=2*this._velocity.x/i.GameConfig.ball.diameter+this._rotation.y,r=this._rotation.z;if(this._orientation.rotate({x:o,y:n,z:r}),this._labelOrient.rotate({x:o,y:n,z:r}),Math.abs(this._rotation.x)<.001&&(this._rotation.x=0),Math.abs(this._rotation.y)<.001&&(this._rotation.y=0),Math.abs(this._rotation.z)<.001&&(this._rotation.z=0),this._velocity.length<u.minVelocityLength)if(this._rotation.x||this._rotation.y){const t=this._rotation.y*i.GameConfig.ball.diameter/2*1.2,e=this._rotation.x*i.GameConfig.ball.diameter/2*1.2;this._velocity=new s.Vector2(t,e),this._rotation.x=0,this._rotation.y=0}else this.velocity=s.Vector2.zero,this._moving=!1}}draw(){this._visible&&n.Canvas2D.drawBall(this._sprite,this._position,this._orientation,this._labelOrient,this._number)}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.State=void 0;e.State=class{constructor(){this.pocketedBalls=[],this.ballInHand=!1,this.isValid=!1}}}]);